norris_2021 <- c("19/01/2021 04/01/2021", "26/01/2021 05/01/2021", "01/02/2021 06/01/2021", "08/02/2021 18/01/2021", "12/02/2021 20/01/2021", "15/02/2021 21/01/2021", "19/02/2021 22/01/2021", "22/02/2021 25/01/2021", "26/02/2021 27/01/2021", "01/03/2021 28/01/2021", "05/03/2021 29/01/2021", "08/03/2021 02/02/2021", "12/03/2021 03/02/2021", "22/03/2021 04/02/2021", "26/03/2021 05/02/2021", "29/03/2021 09/02/2021", "07/05/2021 10/02/2021", "10/05/2021 11/02/2021", "11/05/2021 16/02/2021", "17/05/2021 17/02/2021", "18/05/2021 18/02/2021", "24/05/2021 23/02/2021", "25/05/2021 24/02/2021", "31/05/2021 25/02/2021")

norris_2020 <- c("29/06/2020 15/06/2020", "07/07/2020 16/06/2020", "17/07/2020 17/06/2020", "23/07/2020 20/07/2020", "29/07/2020 21/07/2020", "10/09/2020 04/08/2020", "18/09/2020 05/08/2020", "23/09/2020 06/08/2020", "24/09/2020 07/08/2020", "25/09/2020 10/08/2020", "30/09/2020 11/08/2020", "14/10/2020 12/08/2020", "22/10/2020 13/08/2020", "05/11/2020 07/09/2020", "06/11/2020 08/09/2020", "10/11/2020 09/09/2020", "11/11/2020 11/09/2020", "17/11/2020 14/09/2020", "18/11/2020 15/09/2020", "24/11/2020 16/09/2020", "25/11/2020 17/09/2020")

norris_clean <- c(clean_sitting_days(norris_2021),
                  clean_sitting_days(norris_2020))

t2 <- purrr::map_df(norris_clean, purrr::possibly(~get_contributions(.x, senator = "David Norris"),NULL)) %>%
  mutate(contributed = ifelse(contributions != "",1,0))

tmp <- voting %>%
  filter(member_for == "David Norris") %>%
  mutate(date = format(strptime(debate_date,"%Y-%m-%d"),"%d/%m/%Y")) %>%
  select(date, votes_attended)

tmp2 <- voting %>%
  select(debate_date, votes_per_day) %>%
  group_by(debate_date) %>%
  slice(1) %>%
  ungroup() %>%
  mutate(date = format(strptime(debate_date,"%Y-%m-%d"),"%d/%m/%Y")) %>%
  select(date, votes_per_day)



tmp3 <- left_join(t2,tmp) %>%
  left_join(tmp2) %>%
  mutate(half = )
  mutate(vote_or_cont = case_when(votes_attended == 1 | contributed == 1 ~1,
                                  T ~0)) %>%
  mutate(across(everything(), ~tidyr::replace_na(.x, 0)))



